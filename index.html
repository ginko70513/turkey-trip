<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3/12-3/20 åœŸè€³å…¶å°ˆå±¬è¡Œç¨‹èˆ‡è³¼ç‰©å°èˆª</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#319795">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="åœŸè€³å…¶ä¹‹æ—…">
    <link rel="apple-touch-icon" href="icon-192.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F8FAF5;
            color: #2D3748;
        }
        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 250px;
            max-height: 300px;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .active-tab {
            background-color: #319795;
            color: white;
            border-color: #319795;
            transform: scale(1.05);
        }
        .inactive-tab {
            background-color: white;
            color: #718096;
            border-color: #E2E8F0;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navbar -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 px-4 py-3 shadow-sm flex justify-between items-center">
        <div>
            <h1 class="text-xl font-bold text-teal-700 tracking-wide">ğŸ‡¹ğŸ‡· åœŸè€³å…¶ä¹‹æ—… (3/12-3/20)</h1>
            <p class="text-xs text-gray-500">æ‚¨çš„æ¯æ—¥é£¯åº—èˆ‡è³¼ç‰©æ”»ç•¥</p>
        </div>
        <button onclick="document.getElementById('global-tips').scrollIntoView({behavior: 'smooth'})" class="text-sm bg-orange-100 text-orange-700 px-3 py-1 rounded-full font-medium">
            ğŸ’¡ å¿…è®€æ”»ç•¥
        </button>
    </nav>

    <!-- Timeline Navigation (Scrollable) -->
    <div class="bg-gray-50 py-4 shadow-inner">
        <div class="container mx-auto px-4">
            <h2 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">é¸æ“‡æ—¥æœŸ / è¡Œç¨‹</h2>
            <div id="timeline" class="flex overflow-x-auto space-x-3 pb-2 no-scrollbar snap-x">
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto px-4 py-6 max-w-5xl">

        <!-- Intro & Hotel Context -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Left: Location & Hotel Info -->
            <div class="md:col-span-1">
                <div class="bg-white rounded-xl card-shadow p-5 border-l-4 border-teal-500 h-full flex flex-col justify-between">
                    <div>
                        <span id="day-badge" class="inline-block bg-teal-100 text-teal-800 text-xs px-2 py-1 rounded font-bold mb-2">DAY 1</span>
                        <h2 id="location-title" class="text-2xl font-bold text-gray-800 mb-1">Taipei -> Istanbul</h2>
                        <div class="flex items-center text-gray-600 mt-2">
                            <span class="text-xl mr-2">ğŸ¨</span>
                            <div>
                                <p class="text-xs text-gray-400 uppercase">Tonight's Hotel</p>
                                <p id="hotel-name" class="font-bold text-lg leading-tight">é£›æ©Ÿä¸Š / æ©Ÿå ´</p>
                            </div>
                        </div>
                    </div>
                    <div id="hotel-note" class="mt-4 text-sm text-gray-500 bg-gray-50 p-2 rounded">
                        æº–å‚™å‡ºç™¼ï¼ä»Šæ—¥é‡é»æ˜¯æ©Ÿå ´å…ç¨…åº—èˆ‡ä¼‘æ¯ã€‚
                    </div>
                </div>
            </div>

            <!-- Right: Daily Briefing -->
            <div class="md:col-span-2 bg-white rounded-xl card-shadow p-6">
                <h3 class="font-bold text-gray-700 mb-2 flex items-center">
                    <span class="bg-orange-100 text-orange-600 rounded-full w-6 h-6 flex items-center justify-center text-sm mr-2">!</span>
                    ä»Šæ—¥è³¼ç‰©é‡é»
                </h3>
                <p id="daily-summary" class="text-gray-600 text-sm leading-relaxed mb-4">
                    ä»Šå¤©åœ¨é£›æ©Ÿä¸Šï¼Œå»ºè­°æ‚¨å¯ä»¥ç€è¦½æ©Ÿä¸Šå…ç¨…å•†å“ï¼Œæˆ–æ˜¯åœ¨è½‰æ©Ÿæ™‚è³¼è²·ä¸€äº›ç°¡å–®çš„é›¶é£Ÿã€‚æŠµé”åœŸè€³å…¶å¾Œï¼Œè«‹å¤šåˆ©ç”¨ä¼‘æ¯æ™‚é–“èª¿æ•´æ™‚å·®ã€‚
                </p>

                <!-- Visualization Area -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="bg-gray-50 rounded-lg p-3 border border-gray-100">
                        <h4 class="text-xs font-bold text-gray-500 mb-2 text-center">èµ°è·¯å»è²·è¦å¤šä¹…ï¼Ÿ(åˆ†é˜)</h4>
                        <div class="chart-wrapper" style="height: 180px;">
                            <canvas id="distanceChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 border border-gray-100">
                        <h4 class="text-xs font-bold text-gray-500 mb-2 text-center">é€™è£¡è²·ä»€éº¼æœ€åˆ’ç®—ï¼Ÿ</h4>
                        <div class="chart-wrapper" style="height: 180px;">
                            <canvas id="typeChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Shopping Spots List -->
        <section>
            <div class="flex justify-between items-end mb-4">
                <h3 class="text-xl font-bold text-gray-800">å‘¨é‚Šæ¨è–¦èˆ‡å°èˆª</h3>
            </div>
            <div id="spots-container" class="space-y-4">
            </div>
        </section>

        <!-- Global Tips Section -->
        <section id="global-tips" class="mt-12 bg-teal-800 text-teal-50 rounded-2xl p-8 shadow-lg">
            <h2 class="text-2xl font-bold mb-6 text-center text-white">ğŸ‡¹ğŸ‡· åœŸè€³å…¶è³¼ç‰©ç”Ÿå­˜æ³•å‰‡</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-teal-700 bg-opacity-50 p-4 rounded-lg">
                    <div class="text-3xl mb-2">ğŸ›’</div>
                    <h3 class="font-bold text-white mb-1">èªæ˜å¹³åƒ¹è¶…å¸‚</h3>
                    <p class="text-sm text-teal-100">æƒ³è²·æ°´ã€é¤…ä¹¾ã€ç´…èŒ¶åŒ…ï¼Ÿè«‹åœ¨ Google Map æœå°‹ <strong>"BIM"</strong>, <strong>"A101"</strong> æˆ– <strong>"Migros Jet"</strong>ã€‚åƒ¹æ ¼æ˜¯è§€å…‰å€å•†åº—çš„ä¸€åŠã€‚</p>
                </div>
                <div class="bg-teal-700 bg-opacity-50 p-4 rounded-lg">
                    <div class="text-3xl mb-2">ğŸ§¶</div>
                    <h3 class="font-bold text-white mb-1">æ®ºåƒ¹çš„è—è¡“</h3>
                    <p class="text-sm text-teal-100">åœ¨ç•ªç´…èŠ±åŸã€å¤§å¸‚é›†æˆ–è§€å…‰å€çš„å°åº—ï¼Œ<strong>æ®ºåƒ¹æ˜¯å¿…é ˆçš„</strong>ã€‚é€šå¸¸å¾é–‹åƒ¹çš„ 50%-60% é–‹å§‹å–Šï¼Œä¿æŒå¾®ç¬‘ä½†å …å®šã€‚</p>
                </div>
                <div class="bg-teal-700 bg-opacity-50 p-4 rounded-lg">
                    <div class="text-3xl mb-2">ğŸ’Š</div>
                    <h3 class="font-bold text-white mb-1">è—¥å¦èˆ‡ç«ç‘°æ°´</h3>
                    <p class="text-sm text-teal-100">åœŸè€³å…¶è—¥å¦åº—å« "Eczane"ã€‚è‘—åçš„ç«ç‘°æ°´ (Gulsha) åœ¨é€™è£¡è²·æœ€ä¾¿å®œï¼Œå±ˆè‡£æ° (Watsons) æˆ– Gratis ä¹Ÿæœ‰è³£ã€‚</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-100 text-gray-500 py-6 mt-8 text-center text-xs">
        <p>è¡Œç¨‹æ—¥æœŸï¼š2025/03/12 - 2025/03/20</p>
        <p>ç¥æ‚¨æ—…é€”æ„‰å¿«ï¼App Generated for User</p>
    </footer>

    <script>
        // --- DATA STORE ---
        const tripData = [
            {
                date: "3/12",
                day: "Day 1",
                location: "Taipei -> Istanbul",
                hotel: "æ©Ÿä¸Š / è½‰æ©Ÿ",
                hotelAddress: "",
                summary: "å‡ºç™¼æ—¥ã€‚å»ºè­°åœ¨æ¡ƒåœ’æ©Ÿå ´æˆ–è½‰æ©Ÿé»è³¼è²·å¿…è¦çš„å…ç¨…å“ã€‚æŠµé”ä¼Šæ–¯å¦å ¡é€šå¸¸æ˜¯æ¸…æ™¨æˆ–éš”æ—¥ã€‚",
                shoppingTip: "æ©Ÿä¸Šä¿æ¿•å¾ˆé‡è¦ï¼Œå¤šå–æ°´ã€‚",
                spots: [],
                chartData: { distance: [], types: [0,0,0,0] }
            },
            {
                date: "3/13",
                day: "Day 2",
                location: "Istanbul -> Safranbolu",
                hotel: "Hilton Garden Inn Safranbolu",
                hotelAddress: "Hilton Garden Inn Safranbolu, Safranbolu, KarabÃ¼k, Turkey",
                summary: "ç•ªç´…èŠ±åŸ (Safranbolu) æ˜¯ä¸–ç•Œéºç”¢å±±åŸã€‚é€™è£¡æ˜¯è²·è€æ´¾æ‰‹å·¥è—å“ã€ç•ªç´…èŠ±ç›¸é—œç”¢å“æœ€å¥½çš„åœ°æ–¹ã€‚é£¯åº—è·é›¢è€åŸå€æœ‰ä¸€å°æ®µè·é›¢ï¼Œå»ºè­°æ­è»Šæˆ–åƒåœ˜ç§»å‹•ã€‚",
                shoppingTip: "å¿…è²·ï¼šç•ªç´…èŠ±é¦™çš‚ã€åœŸè€³å…¶è»Ÿç³– (Lokumï¼Œé€™è£¡çš„æœ€è€ç‰Œ)ã€å‚³çµ±éŠ…å™¨ã€‚",
                spots: [
                    { name: "Safranbolu Eski Carsi (è€åŸå€å¸‚é›†)", distance: 25, walkText: "æ­¥è¡Œç´„ 25-30 åˆ† / è»Šç¨‹ 5 åˆ†", type: "å¤è€å¸‚é›†", goods: "ç•ªç´…èŠ±ã€è»Ÿç³–ã€æ‰‹å·¥çš‚ã€çš®é©", price: "$", desc: "é›–ç„¶é›¢é£¯åº—æœ‰é»è·é›¢ï¼Œä½†é€™æ˜¯å¿…é€›é‡é»ã€‚å¤è‰²å¤é¦™ï¼Œè»Ÿç³–è©¦åƒçµ¦å¾ˆå¤§æ–¹ã€‚", mapQuery: "Safranbolu Eski Ã‡arÅŸÄ±, Safranbolu" },
                    { name: "é£¯åº—æ—å°å‹å•†åº—", distance: 5, walkText: "æ­¥è¡Œ 5 åˆ†é˜", type: "ä¾¿åˆ©å•†åº—", goods: "æ°´ã€é›¶é£Ÿ", price: "$", desc: "Hilton ä½æ–¼æ–°åŸå€é‚Šç·£ï¼Œé™„è¿‘æ©Ÿèƒ½è¼ƒç°¡å–®ï¼Œæœ‰å°è¶…å¸‚å¯è£œçµ¦ã€‚", mapQuery: "BIM Market, Safranbolu" }
                ],
                chartData: { distance: [25, 5], types: [10, 80, 10, 0] }
            },
            {
                date: "3/14",
                day: "Day 3",
                location: "Safranbolu -> Ankara -> Cappadocia",
                hotel: "Signature Garden Avanos Hotel",
                hotelAddress: "Signature Garden Avanos Hotel, Avanos, NevÅŸehir, Turkey",
                summary: "é•·é€”æ‹‰è»ŠæŠµé”å¡å¸•å¤šå¥‡äºçš„é˜¿ç“¦è«¾æ–¯ (Avanos) é™¶ç“·å°é®ã€‚é£¯åº—ä½æ–¼é™¶ç“·å€ï¼Œé€™è£¡ä»¥ç´…åœŸé™¶ç“·èåã€‚",
                shoppingTip: "Avanos æ˜¯é™¶è—ä¹‹éƒ½ã€‚é™¤äº†é™¶ç“·ï¼Œé™„è¿‘ä¹Ÿæœ‰è¶…å¸‚å¯ä»¥è²·æ°´æœå’Œå„ªæ ¼ã€‚",
                spots: [
                    { name: "Avanos é™¶ç“·å·¥åŠ", distance: 10, walkText: "æ­¥è¡Œ/è»Šç¨‹ 10 åˆ†é˜å…§", type: "å·¥è—å“", goods: "æ‰‹å·¥å½©ç¹ªé™¶ç“·ã€ç¢—ç›¤", price: "$", desc: "é£¯åº—æœ¬èº«å°±åœ¨ Avanos å€åŸŸï¼Œå‘¨é‚Šæœ‰å¾ˆå¤šé™¶ç“·å±•ç¤ºä¸­å¿ƒï¼Œåƒ¹æ ¼æ¯”ä¼Šæ–¯å¦å ¡ä¾¿å®œã€‚", mapQuery: "Avanos Pottery, Avanos, NevÅŸehir" },
                    { name: "A101 / BIM è¶…å¸‚ (Avanosåº—)", distance: 12, walkText: "æ­¥è¡Œç´„ 10-15 åˆ†é˜", type: "è¶…å¸‚", goods: "ä¾¿å®œçš„é£²ç”¨æ°´ã€ç„¡èŠ±æœä¹¾", price: "$", desc: "é®ä¸Šæœ‰å¹¾é–“å¹³åƒ¹è¶…å¸‚ï¼Œå»ºè­°è²·å¤§ç½æ°´å›é£¯åº—ã€‚", mapQuery: "A101 Market, Avanos, NevÅŸehir" }
                ],
                chartData: { distance: [10, 12], types: [0, 90, 10, 0] }
            },
            {
                date: "3/15",
                day: "Day 4",
                location: "Cappadocia (å…¨æ—¥)",
                hotel: "Signature Garden Avanos Hotel",
                hotelAddress: "Signature Garden Avanos Hotel, Avanos, NevÅŸehir, Turkey",
                summary: "å¡å¸•å¤šå¥‡äºå…¨æ—¥éŠã€‚é™¤äº†ç†±æ°£çƒï¼Œé€™å¤©é€šå¸¸æœƒå»åœ°æ¯¯å·¥å» æˆ–ç å¯¶åº—ï¼ˆåœŸè€³å…¶çŸ³ï¼‰ã€‚å¦‚æœæ‚¨æƒ³è²·ç´€å¿µå“ï¼ŒGoreme é®ä¸Šé¸æ“‡æ¯”è¼ƒå¤šã€‚",
                shoppingTip: "åœ°æ¯¯æ˜¯é«˜åƒ¹å“ï¼Œè«‹é‡åŠ›è€Œç‚ºã€‚åœŸè€³å…¶çŸ³ (Turquoise) æ˜¯ä¸éŒ¯çš„ç´€å¿µå“ã€‚è¶…å¸‚ç¹¼çºŒè£œè²¨ã€‚",
                spots: [
                    { name: "Goreme å¸‚å€å°åº— (éœ€æ­è»Š)", distance: 60, walkText: "éœ€æ­è¨ˆç¨‹è»Š (15åˆ†é˜)", type: "è§€å…‰è¡—å€", goods: "ç†±æ°£çƒé€ å‹ç´€å¿µå“ã€æ˜ä¿¡ç‰‡ã€åœ°æ¯¯", price: "$", desc: "å¦‚æœæ‚¨æœ‰è‡ªç”±æ´»å‹•æ™‚é–“å» Goremeï¼Œé‚£æ˜¯è²·å°ç´€å¿µå“æœ€é›†ä¸­çš„åœ°æ–¹ã€‚", mapQuery: "GÃ¶reme, NevÅŸehir" },
                    { name: "é£¯åº—å‘¨é‚Šæ•£æ­¥", distance: 5, walkText: "æ­¥è¡Œ 5 åˆ†é˜", type: "æ•£æ­¥", goods: "é¢¨æ™¯ã€ç´…æ²³æ™¯è‰²", price: "Free", desc: "Avanos ç´…æ²³é‚Šå¾ˆæ¼‚äº®ï¼Œé©åˆå‚æ™šæ•£æ­¥ï¼Œè³¼ç‰©é»è¼ƒå°‘ã€‚", mapQuery: "KÄ±zÄ±lÄ±rmak River, Avanos" }
                ],
                chartData: { distance: [15, 5], types: [10, 80, 10, 0] }
            },
            {
                date: "3/16",
                day: "Day 5",
                location: "Cappadocia -> Pamukkale",
                hotel: "Pam Thermal Hotel",
                hotelAddress: "Pam Thermal Hotel, KarahayÄ±t, Pamukkale, Denizli, Turkey",
                summary: "æ‹‰è»Šå‰å¾€æ£‰å ¡ (Pamukkale)ã€‚é€™è£¡ç››ç”¢æ£‰èŠ±ï¼Œæ˜¯åœŸè€³å…¶ç´¡ç¹”æ¥­ä¸­å¿ƒã€‚é£¯åº—é€šå¸¸æœ‰æº«æ³‰ã€‚",
                shoppingTip: "é€™æ˜¯è²·æ¯›å·¾ã€æµ´è¢ã€æ£‰Tæœ€åˆ’ç®—çš„ä¸€ç«™ã€‚Karahayit æ‘èŠå°±åœ¨é£¯åº—é™„è¿‘ã€‚",
                spots: [
                    { name: "Karahayit Village (ç´…è‰²æº«æ³‰æ‘)", distance: 10, walkText: "æ­¥è¡Œ 10-15 åˆ†é˜", type: "åœ¨åœ°å¸‚é›†", goods: "æ£‰ç¹”å“ã€æµ´è¢ã€çŸ³æ¦´é†‹", price: "$", desc: "é£¯åº—èµ°å‡ºå»ä¸é å°±æ˜¯å¸‚é›†ï¼Œé€™è£¡çš„ç´¡ç¹”å“ä¿—åˆå¤§ç¢—ï¼Œè¨˜å¾—æ®ºåƒ¹ã€‚", mapQuery: "KarahayÄ±t, Pamukkale, Denizli" },
                    { name: "é£¯åº—å…§å•†åº—", distance: 1, walkText: "é£¯åº—å¤§å»³", type: "ä¾¿åˆ©åº—", goods: "æ³³è¡£ã€æ³³å¸½ (æ³¡æº«æ³‰ç”¨)", price: "$$", desc: "å¦‚æœä½ å¿˜äº†å¸¶æ³³è¡£æ³¡æº«æ³‰ï¼Œåªèƒ½åœ¨é€™è£¡è²·è²´çš„äº†ã€‚", mapQuery: "" }
                ],
                chartData: { distance: [10, 1], types: [60, 20, 20, 0] }
            },
            {
                date: "3/17",
                day: "Day 6",
                location: "Pamukkale -> Izmir",
                hotel: "Kaya Izmir Thermal & Convention",
                hotelAddress: "Kaya Izmir Thermal & Convention, NarlÄ±dere, Ä°zmir, Turkey",
                summary: "å‰å¾€æ„›ç´æµ·å¤§åŸä¼ŠèŒ²å¯†çˆ¾ã€‚Kaya é£¯åº—ä½æ–¼ Narlidere å€ï¼Œé›¢å¸‚ä¸­å¿ƒæœ‰é»è·é›¢ï¼Œä½†é›¢ Agora è³¼ç‰©ä¸­å¿ƒä¸ç®—å¤ªé ã€‚",
                shoppingTip: "é€™æ™šé©åˆå»é€›ç¾ä»£åŒ–çš„ Shopping Mallã€‚Agora Mall æœ‰åœ‹éš›å“ç‰Œï¼Œé€›èµ·ä¾†å¾ˆèˆ’æœã€‚",
                spots: [
                    { name: "Agora Shopping Center", distance: 20, walkText: "æ­¥è¡Œç´„ 20 åˆ† / è»Šç¨‹ 5 åˆ†", type: "å¤§å‹å•†å ´", goods: "H&M, LC Waikiki (åœŸè€³å…¶åœ‹æ°‘ç‰Œ), ç©å…·, ç¾é£Ÿè¡—", price: "$", desc: "éå¸¸å¥½é€›çš„å•†å ´ï¼Œå¦‚æœä¸å¾é£¯åº—èµ°éå»ï¼Œæ­è¨ˆç¨‹è»Šå¾ˆä¾¿å®œä¹Ÿå¾ˆè¿‘ã€‚", mapQuery: "Agora AVM, BalÃ§ova, Ä°zmir" },
                    { name: "IstinyePark Izmir", distance: 40, walkText: "è»Šç¨‹ç´„ 10-15 åˆ†", type: "é ‚ç´šå•†å ´", goods: "ç²¾å“ã€é«˜ç«¯æ™‚å°š", price: "$$", desc: "ä¼ŠèŒ²å¯†çˆ¾æœ€é«˜ç´šçš„å•†å ´ï¼Œå»ºç¯‰å¾ˆç¾ï¼Œé©åˆæƒ³çœ‹ç²¾å“çš„äººã€‚", mapQuery: "Ä°stinyePark Ä°zmir, BalÃ§ova, Ä°zmir" }
                ],
                chartData: { distance: [20, 10], types: [80, 0, 10, 10] }
            },
            {
                date: "3/18",
                day: "Day 7",
                location: "Izmir -> Istanbul",
                hotel: "Grand Halic Hotel",
                hotelAddress: "Grand Halic Hotel, KemankeÅŸ Karamustafa PaÅŸa, BeyoÄŸlu, Ä°stanbul, Turkey",
                summary: "å›åˆ°ä¼Šæ–¯å¦å ¡ã€‚Grand Halic é£¯åº—ä½ç½®çµ•ä½³ï¼ä½æ–¼é‡‘è§’ç£æ—ï¼Œæ­¥è¡Œå¯é”ä½©æ‹‰å€ (Pera) å’Œç¨ç«‹å¤§é“ã€‚",
                shoppingTip: "ä¼Šæ–¯å¦å ¡ç²¾è¯ï¼æ™šä¸Šç›´æ¥èµ°å»ç¨ç«‹å¤§é“ (Istiklal) æ„Ÿå—å¤œç”Ÿæ´»å’Œè³¼ç‰©ã€‚",
                spots: [
                    { name: "Istiklal Street (ç¨ç«‹å¤§é“)", distance: 10, walkText: "æ­¥è¡Œ 8-12 åˆ†é˜", type: "æ­¥è¡Œè¡—", goods: "ç¾å¦ (Flormar, Golden Rose), è¡£æœ (Mango, Zara), ç”œé»", price: "$", desc: "åœŸè€³å…¶çš„é¦™æ¦­å¤§é“ã€‚å»ºè­°å» Hafiz Mustafa 1864 è²·ç²¾è£è»Ÿç³–ç•¶ä¼´æ‰‹ç¦®ã€‚", mapQuery: "Ä°stiklal Caddesi, BeyoÄŸlu, Ä°stanbul" },
                    { name: "ÅiÅŸhane åœ°éµç«™å‘¨é‚Š", distance: 5, walkText: "æ­¥è¡Œ 5 åˆ†é˜", type: "è¨­è¨ˆå°åº—", goods: "è¨­è¨ˆç‡ˆé£¾ã€å®¶é£¾", price: "$", desc: "é£¯åº—é™„è¿‘å¾ˆå¤šè³£ç‡ˆé£¾å’Œæ¨‚å™¨çš„åº—ï¼Œå¾ˆæœ‰æ°£æ°›ã€‚", mapQuery: "ÅiÅŸhane Metro, BeyoÄŸlu, Ä°stanbul" }
                ],
                chartData: { distance: [10, 5], types: [50, 40, 10, 0] }
            },
            {
                date: "3/19",
                day: "Day 8",
                location: "Istanbul (Free Day)",
                hotel: "Grand Halic Hotel",
                hotelAddress: "Grand Halic Hotel, KemankeÅŸ Karamustafa PaÅŸa, BeyoÄŸlu, Ä°stanbul, Turkey",
                summary: "ä¼Šæ–¯å¦å ¡å…¨æ—¥ã€‚é€™æ˜¯æœ€å¾Œè£œè²¨çš„æ©Ÿæœƒã€‚å»ºè­°å‰å¾€é¦™æ–™å¸‚é›† (Spice Bazaar) æˆ–å¤§å¸‚é›† (Grand Bazaar)ã€‚",
                shoppingTip: "é¦™æ–™å¸‚é›†è²·æœä¹¾ã€èŠ±èŒ¶ã€é¦™æ–™ã€‚å¤§å¸‚é›†è²·çš®è¡£ã€é‡‘é£¾ã€å½©ç›¤ã€‚è¨˜å¾—ï¼šè²¨æ¯”ä¸‰å®¶ä¸åƒè™§ã€‚",
                spots: [
                    { name: "Egyptian Bazaar (é¦™æ–™å¸‚é›†)", distance: 20, walkText: "æ­¥è¡Œç´„ 20 åˆ† / è¼•è»Œ 10 åˆ†", type: "å‚³çµ±å¸‚é›†", goods: "åœŸè€³å…¶è»Ÿç³–(ç§¤é‡), è˜‹æœèŒ¶, ç•ªç´…èŠ±, çƒé­šå­", price: "$", desc: "æ¯”å¤§å¸‚é›†æ›´è¦ªæ°‘ï¼Œæ›´å¥½è²·åœŸç”¢ã€‚å»ºè­°åœ¨é€™è£¡è²·é½Šæ‰€æœ‰åƒçš„ä¼´æ‰‹ç¦®ã€‚", mapQuery: "MÄ±sÄ±r Ã‡arÅŸÄ±sÄ±, EminÃ¶nÃ¼, Ä°stanbul" },
                    { name: "Grand Bazaar (å¤§å¸‚é›†)", distance: 25, walkText: "æ­¥è¡Œ 25 åˆ† / è¼•è»Œ T1 ç·š", type: "è¶…å¤§å‹å¸‚é›†", goods: "é‡‘é£¾, åœ°æ¯¯, çš®ä»¶, ä»¿å†’å“", price: "$-$$", desc: "è¿·å®®ä¸€æ¨£çš„åœ°æ–¹ï¼Œåƒè§€æ€§è³ªå¤§æ–¼è³¼ç‰©ï¼Œé™¤éä½ æ˜¯æ®ºåƒ¹é«˜æ‰‹ã€‚", mapQuery: "KapalÄ±Ã§arÅŸÄ±, BeyazÄ±t, Ä°stanbul" },
                    { name: "Galata Tower (åŠ æ‹‰é”å¡”) å‘¨é‚Š", distance: 10, walkText: "æ­¥è¡Œ 10 åˆ†é˜", type: "æ–‡å‰µè¡—å€", goods: "æ–‡å‰µå°ç‰©, è¨­è¨ˆTæ¤", price: "$", desc: "é£¯åº—å¾€å¡”çš„æ–¹å‘èµ°ï¼Œæœ‰å¾ˆå¤šæ–‡é’å°åº—ã€‚", mapQuery: "Galata Kulesi, BeyoÄŸlu, Ä°stanbul" }
                ],
                chartData: { distance: [20, 25], types: [20, 60, 20, 0] }
            },
            {
                date: "3/20",
                day: "Day 9",
                location: "Istanbul -> Taipei",
                hotel: "æº«æš–çš„å®¶",
                hotelAddress: "Istanbul Airport (IST), ArnavutkÃ¶y, Ä°stanbul, Turkey",
                summary: "æ‰“åŒ…å›åºœã€‚ä¼Šæ–¯å¦å ¡æ–°æ©Ÿå ´ (IST) éå¸¸å¤§ï¼Œå…ç¨…åº—éå¸¸å¤šï¼Œæ˜¯æœ€å¾ŒèŠ±æ‰é‡Œæ‹‰çš„å¥½åœ°æ–¹ã€‚",
                shoppingTip: "æ©Ÿå ´ç‰©åƒ¹è¼ƒé«˜ (æ­å…ƒè¨ˆåƒ¹ç‚ºä¸»)ï¼Œå»ºè­°æŠŠé‡Œæ‹‰é›¶éŒ¢åœ¨å¸‚å€èŠ±å®Œã€‚æ©Ÿå ´é©åˆè²·é…’æˆ–åœ‹éš›ç²¾å“ã€‚",
                spots: [
                    { name: "IST Airport Duty Free", distance: 0, walkText: "æ©Ÿå ´å…§", type: "å…ç¨…åº—", goods: "è¸é…’, Godiva, åœ‹éš›ç²¾å“", price: "$$", desc: "ä¸–ç•Œæœ€å¤§çš„æ©Ÿå ´ä¹‹ä¸€ï¼Œé ç•™ 2-3 å°æ™‚é€›è¡—æ˜¯åˆç†çš„ã€‚", mapQuery: "" }
                ],
                chartData: { distance: [0], types: [30, 30, 10, 30] }
            }
        ];

        // --- APP STATE & RENDER LOGIC ---
        let currentIndex = 0;
        let distChart = null;
        let typeChart = null;

        function initApp() {
            renderTimeline();
            loadDate(0);
        }

        function renderTimeline() {
            const container = document.getElementById('timeline');
            container.innerHTML = tripData.map((item, idx) => `
                <button onclick="loadDate(${idx})"
                    class="flex-shrink-0 min-w-[80px] px-3 py-2 rounded-lg border text-center transition-all duration-200 snap-center
                    ${idx === 0 ? 'active-tab' : 'inactive-tab'}"
                    id="tab-${idx}">
                    <div class="text-xs font-bold opacity-70">${item.date}</div>
                    <div class="text-sm font-bold">${item.day}</div>
                    <div class="text-[10px] truncate w-full">${item.location.split('->')[0]}</div>
                </button>
            `).join('');
        }

        function loadDate(idx) {
            currentIndex = idx;
            const data = tripData[idx];

            document.querySelectorAll('#timeline button').forEach((btn, i) => {
                if (i === idx) {
                    btn.className = "flex-shrink-0 min-w-[80px] px-3 py-2 rounded-lg border text-center transition-all duration-200 snap-center active-tab shadow-md";
                } else {
                    btn.className = "flex-shrink-0 min-w-[80px] px-3 py-2 rounded-lg border text-center transition-all duration-200 snap-center inactive-tab hover:bg-gray-50";
                }
            });

            document.getElementById('day-badge').innerText = `${data.day} â€¢ ${data.date}`;
            document.getElementById('location-title').innerText = data.location;
            document.getElementById('hotel-name').innerText = data.hotel;
            document.getElementById('hotel-note').innerText = data.shoppingTip;
            document.getElementById('daily-summary').innerText = data.summary;

            const spotsContainer = document.getElementById('spots-container');
            if (data.spots.length === 0) {
                spotsContainer.innerHTML = `<div class="p-6 bg-gray-50 rounded-lg text-center text-gray-500">æœ¬æ—¥è¡Œç¨‹ä»¥äº¤é€š/æ©Ÿå ´ç‚ºä¸»ï¼Œè«‹æŠŠæ¡æ©Ÿå ´å…ç¨…åº—æ©Ÿæœƒï¼</div>`;
            } else {
                spotsContainer.innerHTML = data.spots.map((spot, i) => `
                    <div class="bg-white rounded-lg border border-gray-200 p-4 flex flex-col sm:flex-row justify-between items-start hover:border-teal-300 transition-colors">
                        <div class="mb-2 sm:mb-0 flex-1">
                            <h4 class="font-bold text-gray-800 text-lg flex items-center flex-wrap">
                                ${spot.name}
                                <span class="ml-2 text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded border">${spot.type}</span>
                            </h4>
                            <p class="text-sm text-gray-600 mt-1"><span class="font-semibold text-teal-600">æ¨è–¦è³¼è²·ï¼š</span>${spot.goods}</p>
                            <p class="text-xs text-gray-400 mt-2 italic">"${spot.desc}"</p>
                        </div>
                        <div class="flex flex-col items-end min-w-[100px]">
                            <span class="text-xs font-bold bg-teal-50 text-teal-700 px-2 py-1 rounded mb-1">${spot.walkText}</span>
                            <span class="text-xs font-bold text-gray-400 mb-2">åƒ¹æ ¼: ${spot.price}</span>
                            ${spot.mapQuery ? `<button onclick="navigate(${i})" class="bg-blue-500 hover:bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-full flex items-center gap-1 transition-colors">
                                <span>ğŸ“</span> å°èˆªå‰å¾€
                            </button>` : ''}
                        </div>
                    </div>
                `).join('');
            }

            updateCharts(data);
            document.getElementById(`tab-${idx}`).scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'center'});
        }

        function updateCharts(data) {
            const ctxDist = document.getElementById('distanceChart').getContext('2d');
            if (distChart) distChart.destroy();

            const distLabels = data.spots.length ? data.spots.map(s => s.name.substring(0, 8) + '...') : ['N/A'];
            const distValues = data.spots.length ? data.spots.map(s => s.distance) : [0];

            distChart = new Chart(ctxDist, {
                type: 'bar',
                data: {
                    labels: distLabels,
                    datasets: [{
                        label: 'æ­¥è¡Œæ™‚é–“ (åˆ†)',
                        data: distValues,
                        backgroundColor: '#81E6D9',
                        borderColor: '#38B2AC',
                        borderWidth: 1,
                        borderRadius: 4,
                        barThickness: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: { beginAtZero: true, grid: { display: false } },
                        y: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });

            const ctxType = document.getElementById('typeChart').getContext('2d');
            if (typeChart) typeChart.destroy();

            typeChart = new Chart(ctxType, {
                type: 'doughnut',
                data: {
                    labels: ['æœé£¾/æ™‚å°š', 'ä¼´æ‰‹ç¦®/å·¥è—', 'è¶…å¸‚/ç”Ÿæ´»', 'ç²¾å“/å…¶ä»–'],
                    datasets: [{
                        data: data.chartData.types,
                        backgroundColor: ['#F6AD55', '#68D391', '#63B3ED', '#A0AEC0'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { boxWidth: 10, font: { size: 10 } } }
                    }
                }
            });
        }

        function navigate(spotIndex) {
            const data = tripData[currentIndex];
            const spot = data.spots[spotIndex];
            if (!spot.mapQuery) return;
            const origin = encodeURIComponent(data.hotelAddress);
            const destination = encodeURIComponent(spot.mapQuery);
            const url = `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${destination}&travelmode=walking`;
            window.open(url, '_blank');
        }

        // Initialize app
        window.addEventListener('DOMContentLoaded', initApp);

        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
                .then(reg => console.log('SW registered:', reg.scope))
                .catch(err => console.log('SW registration failed:', err));
        }
    </script>
</body>
</html>
